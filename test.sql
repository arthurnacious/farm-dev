SELECT f.*, COALESCE(AVG(fr.star_rating), 0) AS average_rating, COUNT(DISTINCT fr.hunter_id) as count_rating, AVG(au.price) AS avg_price, MIN(au.price) AS min_price, MAX(au.price) AS max_price, 
(6371 * acos(cos(radians(-29.116395)) * cos(radians(f.latitude)) * cos(radians(f.longitude) - radians(26.215496) + sin(radians(-29.116395)) * sin(radians(f.latitude)))))
 AS distance_value FROM farm f LEFT JOIN farm_features ff ON f.farm_id = ff.farm_id LEFT JOIN reference_features rf ON ff.feature_id = rf.id LEFT JOIN farm_ratings fr ON f.farm_id = fr.farm_id LEFT JOIN accommodation_units au ON f.farm_id = au.farm_id LEFT JOIN bookings b ON b.farm_id = au.farm_id WHERE f.district LIKE '%Bloemfontein%' AND f.latitude BETWEEN -29.2763950 AND -28.9563950 AND f.longitude BETWEEN 26.0554960 AND 26.3754960 GROUP BY f.farm_id HAVING distance_value < 1 ORDER BY f.farm_id